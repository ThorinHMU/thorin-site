<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" type="text/css">
        <script src="https://d3js.org/d3.v4.js"></script>
        <title>Stat</title>
        <meta name="description" content="un site de gestion d'un serveur minecraft">
        <link rel="icon" href="{{ url_for('static', filename='img/assets/icon.png') }}">
    </head>

    <body>
        {% include 'nav.html'%}
        <div id="all">
            <div id="main">
                <h2 id="titre">{{stat}}</h2>
                <div id="b1">
                    <svg id="myPlot"></svg>
                    <div id="info-list"></div>
                </div>
                <script>
                    var date = {{ date|tojson }};
                    console.log("date", date)
                </script>

                <div>
                    <button onclick="navigate(-1)" class="btn">Jour précédent</button>
                    <button onclick="navigate(1)" class="btn">Jour suivant</button>
                    <button class="btn" id="dezoom_graph">Dézommer</button>
                    <form>
                        <p style="margin: 10px 0px">
                            <input type="date" name="date" id="nom" class="btn">
                            <input type="button" value="envoie" class="btn" onclick="send()">
                        </p>
                    </form>
                </div>
            </div>
            <div id="b2"></div>
        </div>
        <script>
            let timeoutId = null;
            function send(){
                date = document.getElementById("nom").value
                send_data(document.getElementById("nom").value);
                console.log(document.getElementById("nom").value);
            }

            function navigate(offset) {
                
                var currentDate = new Date(date);
                var nextDate = new Date(currentDate);
                nextDate.setDate(currentDate.getDate() + offset);
                var year = nextDate.getFullYear();
                var month = String(nextDate.getMonth() + 1).padStart(2, '0');
                var day = String(nextDate.getDate()).padStart(2, '0');
                var isoDate = year + '-' + month + '-' + day;
                
                date = isoDate;
                if (timeoutId) {
                    clearTimeout(timeoutId);
                }
                document.getElementById("titre").textContent = date;
                timeoutId = setTimeout(function() {
                    send_data(date);
                }, 500)
            }
        </script>
        <script src="{{ url_for('static', filename='js/script.js') }}"></script>
        <script src="{{ url_for('static', filename='js/nav.js') }}"></script>
    </body>
</html>
